# EsportsFan

Technical test: cf [instructions](./INSTRUCTIONS.md).

An e-sports website and newsletter.

Features:
- Send a newsletter with last results and upcoming matches every 7 days (based on Pandascore API)
- Custom newsletter: users can pick one or more games they're interested in.
- Newletters are visible in dev in http://localhost:4000/dev/mailbox


## Run the project

Requirements:
- Elixir 1.19 & Erlang 28
- PostgreSQL
- env var `PANDASCORE_API_KEY`: a [PandaScore](https://www.pandascore.co/) token. The free tier is enough.

### Prepare the DB

You need a PostgreSQL instance. You can use the _docker-compose.yml_.
```shell
# To create and start the container
$ docker compose up -d postgres

# start the container
$ docker compose start postgres
```

You can set up the DB with:
```shell
$ mix ecto.setup
```
This command will create the database, run the migrations and seed the db with fake users (cf [mix.exs](./mix.exs)).

> [!IMPORTANT]
> The seed script only creates users. It does **not** create NewsletterWorker (Oban) jobs for these users. 
> You will need to do this from iex console. cf [.iex.exs](./.iex.exs)

To start your Phoenix server:

* Run `mix setup` to install and setup dependencies
* Start Phoenix endpoint with `mix phx.server` or inside IEx with `iex -S mix phx.server`

Now you can visit [`localhost:4000`](http://localhost:4000) from your browser.

## Running the tests

```shell
$ mix test
```

It will create and setup a test database called `esports_fan_test` if it doesn't exist.

## Missing parts

No real front-end with Surface UI. It's mostly LiveViews generated by Phoenix generators.

No observability for production besides logs.

